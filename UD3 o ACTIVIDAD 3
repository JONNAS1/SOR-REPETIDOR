#UO Unidad organizativa
#Creación de la unidad organizativa nombrada departamento:
New-ADOrganizationalUnit -Name "empresa" -Path "DC=JMG,DC=LOCAL" -Description "descripcion"

#Creación de una nueva unidad organizativa (VENTAS) dentro de la unidad organizativa llamada empresa:
New-ADOrganizationalUnit -Name "VENTAS" -Path "OU=empresa,DC=empresa,DC=LOCAL" -Description "Departamento de ventas"

#Creación de una nueva unidad organizativa (COMPRAS) dentro de la unidad organizativa llamada empresa:
New-ADOrganizationalUnit -Name "COMPRAS" -Path "OU=empresa,DC=empresa,DC=LOCAL" -Description "Departamento de compras"

#Creación de una nueva unidad organizativa (CONTABILIDAD) dentro de la unidad organizativa llamada empresa:
New-ADOrganizationalUnit -Name "CONTABILIDAD" -Path "OU=empresa,DC=empresa,DC=LOCAL" -Description "Departamento de contabilidad"

#Usuario
#Creación del usuario 1 David del departamento VENTAS:
New-ADUser -Name "David" -Path "OU=VENTAS,DC=EMPRESA,DC=LOCAL"
-SamAccountName "David" -UserPrincipalName "David@EMPRESA.LOCAL"
-AccountPassword (ConvertTo-SecureString "DAV.VEN1."-AsPlainText -Force)
-GivenName "David" -Surname "Segarra" -ChangePasswordAtLogon $true
-Enabled $true

#Creación del usuario 2 Marcos del departamento VENTAS:
New-ADUser -Name "Marcos" -Path "OU=VENTAS,DC=EMPRESA,DC=LOCAL"
-SamAccountName "Marcos" -UserPrincipalName "Marcos@EMPRESA.LOCAL"
-AccountPassword (ConvertTo-SecureString "MA.VEN2."-AsPlainText -Force)
-GivenName "Marcos" -Surname "Gonzalez" -ChangePasswordAtLogon $true
-Enabled $true

#Creación del usuario 2 Marcos del departamento VENTAS:
New-ADUser -Name "Adrian" -Path "OU=VENTAS,DC=EMPRESA,DC=LOCAL"
-SamAccountName "Marcos" -UserPrincipalName "Adrian@EMPRESA.LOCAL"
-AccountPassword (ConvertTo-SecureString "AD.VEN2."-AsPlainText -Force)
-GivenName "Adrian" -Surname "Serrano" -ChangePasswordAtLogon $true
-Enabled $true




#Para deshabilitar cuentas de usuario:
#De manera larga y fiable:
Disable-ADAccount -Identity "CN=David Segarra,OU=VENTAS,DC=Empresa,DC=Local"
#De manera corta:
Disable-ADAccount -Identity "David" 

#Para habilitar cuentas de usuario:
Enable-ADAccount -Identity "CN=David Segarra,OU=VENTAS,DC=Empresa,DC=Local"
